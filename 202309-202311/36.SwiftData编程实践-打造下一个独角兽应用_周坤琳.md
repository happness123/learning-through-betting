# **SwiftDataå®žè·µï¼Œæ‰“é€ ä¸‹ä¸€ä¸ªç‹¬è§’å…½åº”ç”¨**


![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/1.png?raw=ture)

# **éšäºŽå¸‚,ç‹¬æœ¨æˆç³**

ä¸ºäº†æ›´å¥½çš„é˜…è¯»ä½“éªŒ,å¯ä»¥æ‰’æ‹‰åˆ°æ–‡æœ«ä»Žã€Œ**[é˜…è¯»åŽŸæ–‡](https://kxv36hgn51.feishu.cn/wiki/XAiawXqeqilpyEkoGxucm4pFnTy?from=from_copylink)**ã€è¿›å…¥é£žä¹¦æ–‡æ¡£.æˆ–è€…è¿›å…¥æ–‡æ¡£ç½‘å€: 

https://kxv36hgn51.feishu.cn/wiki/XAiawXqeqilpyEkoGxucm4pFnTy?from=from_copylink

> For a better reading experience, you can scroll to the end of the article from the "read the original text" to enter the Flying Book document. Or you can go to the document website. 





# **å›½é™…æƒ¯ä¾‹,å…ˆçœ‹æ•ˆæžœ**

> International practice, first look at the effect

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/2è‹¹æžœappæ•°æ®é›•åˆ».gif?raw=ture)

æ€Žä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯æŒºé…·çš„ï¼Ÿ

> How about it? Isn't it cool?

ç»è¿‡å‰é¢çš„[è‹¹æžœappå…¨æ ˆå¼€å‘](https://kxv36hgn51.feishu.cn/wiki/Bm1OwLaOEiAA8ikK68gc4T6anjc)å’Œ[è‹¹æžœappç‚«é…·åŠ¨æ•ˆ](https://kxv36hgn51.feishu.cn/wiki/EsRtwXvrIi7T9RkVzoDctZdSnIc)å®žè·µï¼Œç›¸ä¿¡ä½ å¯¹å¼€å‘è‹¹æžœappçš„å¼€å‘æœ‰äº†å¤§ä½“çš„äº†è§£ã€‚ä¸€ä¸ªå®Œæ•´çš„appé™¤äº†å¤§å®¶èƒ½çœ‹åˆ°çš„ç”¨æˆ·ç•Œé¢ï¼Œè¿˜æœ‰èƒŒåŽçš„æ•°æ®éœ€è¦å¤„ç†ï¼Œè‡ªä»ŽXcodeå‡çº§åˆ°15ä¹‹åŽå°±æ”¯æŒDataäº†(2023/10/01)ï¼Œè¶ç€çƒ­ä¹Žå°±æ¥çŽ©ä¸€çŽ©ï¼Œæ‰¿æŽ¥ä¹‹å‰çš„æ–‡ç« ï¼ŒæŽ¥ç€å®Œå–„å’±ä»¬çš„TodoList(å¾…åŠž)ï¼Œä¸å¥½é«˜éª›è¿œï¼Œæ—¥æ‹±ä¸€å’ã€‚

> After the previous Apple app full stack development and Apple app cool motion graphics practice, I believe you have a general understanding of the development of Apple apps. In addition to the User Interface that everyone can see, a complete app also needs to process the data behind it. Since Xcode upgraded to 15, it supports Data (2023/10/01). Take advantage of the heat to play, continue the previous article, and then improve our TodoList (to-do). Don't aim too high, just die.

# **æ•°æ®æ¨¡åž‹**

> Data model

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/3.png?raw=ture)

æ–°å»ºä¸€ä¸ªSwift Fileæ–‡æ¡£ï¼Œå–åä¸º**`ToDoItem`****ï¼Œ**è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

> Create a new Swift File document named ToDoItem and enter the following code:

```Swift
import Foundation
import SwiftData


@Model
final class ToDoItem {
    var title: String
    var timestamp: Date
    var isCritical: Bool
    var isCompleted: Bool

    init(title: String = "",
         timestamp: Date = .now,
         isCritical: Bool = false,
         isCompleted: Bool = false) {
        self.title = title
        self.timestamp = timestamp
        self.isCritical = isCritical
        self.isCompleted = isCompleted
    }
}
```

è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º**`ToDoItem`****çš„æ•°æ®æ¨¡åž‹**ï¼Œè¡¨ç¤ºå¾…åŠžäº‹é¡¹ã€‚å®ƒåŒ…å«äº†å¾…åŠžäº‹é¡¹çš„**æ ‡é¢˜ï¼ˆtitleï¼‰**ã€**æ—¶é—´æˆ³ï¼ˆtimestampï¼‰**ã€**æ˜¯å¦ç´§æ€¥ï¼ˆisCriticalï¼‰**ï¼Œä»¥åŠ**æ˜¯å¦å·²å®Œæˆï¼ˆisCompletedï¼‰**çš„å˜é‡ã€‚

> This code defines a data model called ToDoItem, which represents to-do items. It contains variables such as the title, timestamp, isCritical, and isCompleted of the to-do item.

- **`title: String = ""`**ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»åž‹çš„å‚æ•°ï¼Œè¡¨ç¤º**å¾…åŠžäº‹é¡¹çš„æ ‡é¢˜**ã€‚å®ƒæœ‰ä¸€ä¸ª**é»˜è®¤å€¼æ˜¯ç©ºå­—ç¬¦**ä¸²ï¼Œæ„å‘³ç€å¦‚æžœç”¨æˆ·ä¸æä¾›æ ‡é¢˜ä¼šç”¨ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œä¸è‡³äºŽå°±æ­»æœºäº†ã€‚

> Title: String = "": This is a string parameter that represents the title of the to-do item. It has a default value ofempty string, which means that if the user does not provide the title, it will be used as an empty string, so it will not crash.

- **`timestamp: Date = .now`**ï¼šè¿™æ˜¯ä¸€ä¸ªæ—¥æœŸç±»åž‹çš„å‚æ•°ï¼Œè¡¨ç¤º**å¾…åŠžäº‹é¡¹çš„æ—¶é—´æˆ³**ã€‚å®ƒæœ‰ä¸€ä¸ª**é»˜è®¤å€¼æ˜¯å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´**ï¼ˆé€šè¿‡è°ƒç”¨**`.now`**èŽ·å–ï¼‰ï¼Œå¦‚æžœä½ ä¸æä¾›æ—¶é—´æˆ³ï¼Œå®ƒå°†è¢«åˆå§‹åŒ–ä¸ºå½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚

> Timestamp: Date = .now: This is a date type parameter that represents the timestamp of the to-do item. It has a default value of the current date and time (obtained by calling .now). If you do not provide a timestamp, it will be initialized to the current date and time.

- **`isCritical: Bool = false`**ï¼šè¿™æ˜¯ä¸€ä¸ªå¸ƒå°”ç±»åž‹çš„å‚æ•°ï¼Œè¡¨ç¤º**å¾…åŠžäº‹é¡¹æ˜¯å¦ç´§æ€¥**ã€‚å®ƒæœ‰ä¸€ä¸ªé»˜è®¤å€¼æ˜¯`false`ï¼Œå¦‚æžœä½ ä¸æä¾›æ˜¯å¦ç´§æ€¥çš„ä¿¡æ¯å°±æ²¡æœ‰æ ‡é¢˜ä¸Šçš„æ„Ÿå¹å·**`ï¼ï¼ï¼`**ã€‚

> IsCritical: Bool = false: This is a boolean parameter indicating whether the to-do item is urgent. It has a default value of false, and there is no exclamation mark on the title if you do not provide information on whether it is urgent!!!.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/4.png?raw=ture)

- **`isCompleted: Bool = false`**ï¼šè¿™æ˜¯å¦ä¸€ä¸ªå¸ƒå°”ç±»åž‹çš„å‚æ•°ï¼Œè¡¨ç¤º**å¾…åŠžäº‹é¡¹æ˜¯å¦å·²ç»å®Œæˆ**ã€‚å®ƒåŒæ ·æœ‰ä¸€ä¸ªé»˜è®¤å€¼æ˜¯`false`ï¼Œå¦‚æžœä½ ä¸æä¾›æ˜¯å¦å®Œæˆçš„ä¿¡æ¯ï¼Œå®ƒå°†è¢«åˆå§‹åŒ–ä¸ºç°è‰²çš„å°å‹¾å‹¾ã€‚

> isCompleted: Bool = false: This is another boolean parameter indicating whether the to-do item has been completed. It also has a default value of false. If you do not provide information on whether it has been completed, it will be initialized as a small gray tick.

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ï¼Œæ¯”å¦‚ï¼š

> Of course, default values can also be used, for example:

```Swift
let myToDoItem = ToDoItem(title: "å®Œæˆç¼–ç¨‹ä½œä¸š")
```

æž„å»ºå®Œè¿™ä¸ªæ•°æ®æ¨¡åž‹ä¹‹åŽçœ‹ç€å®ƒä»¬æˆ‘é™·å…¥äº†æ·±æ€ï¼Œ**è¿™ä¸å°±æ˜¯Pythonä¸­â€œç±»â€çš„æ ·å­å—ï¼Ÿå­¦è¿‡pythonçš„å°ä¼™ä¼´ç§’æ‡‚å•Šï¼Œ**æžœç„¶**ç¼–ç¨‹è¯­è¨€ä¸€å®¶äº²å•Š**ï¼Œè¿žç»“æž„åŒ–çš„æ–¹å¼éƒ½å·®ä¸å¤šï¼Œæ–¹ä¾¿å‚æ•°åœ¨åŒä¸€ä¸ª**`class(ç±»)`**é‡Œè·¨å‡½æ•°ä¼ é€’ï¼Œé«˜å¤§ä¸Šçš„è¯è¯­å°±æ˜¯**é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP)**

> After building this data model, I fell into deep thought when I looked at them. Isn't this what "classes" look like in Python? Friends who have learned Python understand it in seconds. Indeed, programming languages are family-friendly. Even the structured methods are similar, making it convenient for parameters to be passed across functions in the same class. The fancy term is Object Oriented Programming (OOP).

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/5.png?raw=ture)

å½“ä½ å­¦ä¼šä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶ä¸”ä¸éª—è‡ªå·±**è€è€å®žå®žçš„æ‰“å¥½åŸºç¡€ï¼Œä¹Ÿå°±æ˜¯æœ€å°‘å¿…è¦çš„æ¦‚å¿µï¼Œ**å†æ ¹æ®è‡ªå·±å‘å¾€çš„æ–¹å‘åŽ»å­¦ä¹ æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œ**é€šå¸¸å°±ä¼šâ€œç§’æ‡‚â€**ï¼Œè¿™æ„Ÿè§‰åˆ«æå¤šçˆ½äº†ã€‚å¯èƒ½å­¦ä¹ ç¬¬ä¸€é—¨ç¼–ç¨‹è¯­è¨€éœ€è¦2å¹´ï¼Œè€Œæ–°å­¦å¦ä¸€é—¨è¯­è¨€å°±åªéœ€è¦çŸ­çŸ­3ä¸ªæœˆï¼Œ**æ— å¤–ä¹Žå°±æ˜¯å†™æ³•ä¸ä¸€æ ·å˜›**ã€‚

> When you learn a programming language and lay a solid foundation without deceiving yourself, that is, the minimum necessary concepts, and then learn a new programming language according to your desired direction, you will usually "understand" in seconds, which feels great. It may take 2 years to learn the first programming language, while it only takes 3 months to learn another language, which is nothing more than a different way of writing.

æŽ¥ç€å’±ä»¬æŠŠå®šä¹‰å¥½çš„è¿™ä¸ª**`ToDoItem`**æ•°æ®æ¨¡åž‹åœ¨**CalendarApp**é‡Œäº¤ç»™**ContenView**ä½¿ç”¨:

> Next, let's hand over the defined ToDoItem data model to ContenView for use in CalendarApp.

```Swift
.modelContainer(for: ToDoItem.self)
```

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/6.png?raw=ture)

è¿™æ ·å°±å®Œæˆäº†æ•°æ®çš„äº¤æŽ¥ï¼Œé‚£ä¹ˆå¦‚ä½•æŽ¥æ”¶ç”¨æˆ·è¾“å…¥çš„æ•°æ®å‘¢ï¼Ÿ

> This completes the handover of data, so how to receive user input data?

# **è¡¨å•**

> Form

è¿™æ—¶å°±éœ€è¦è®¾è®¡ä¸€ä¸ªå¼¹çª—ï¼Œ**æ–°å»ºçª—å£****`CreateView`**

> At this point, you need to design a pop-up window and create a new window, CreateView.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/7.png?raw=ture)

è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

> Enter the following code:

```Swift
import SwiftUI

struct CreateTodoView: View {
    
    @Environment(\.dismiss) var dismiss
    @Environment(\.modelContext) var context
    
    @State private var item = ToDoItem()
    
    var body: some View {
        List {
            TextField("å¾…åŠžäº‹é¡¹", text: $item.title)
            DatePicker("é€‰æ‹©æ—¥æœŸ",
                       selection: $item.timestamp)
            Toggle("é‡è¦çš„?", isOn: $item.isCritical)
            Button("åˆ›å»º") {
                withAnimation {
                    context.insert(item)
                }
                dismiss()
            }
        }
        .navigationTitle("åˆ›å»ºä»£åŠžäº‹é¡¹")
    }
}
#Preview {
    CreateTodoView()
        .modelContainer(for: ToDoItem.self)
}
```

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/8.png?raw=ture)

æƒ³è±¡ä½ æ­£åœ¨è®¾è®¡ä¸€ä¸ªç®€å•çš„å¾…åŠžäº‹é¡¹å·¥åŽ‚ï¼Œä½ å¸Œæœ›ç”¨æˆ·å¯ä»¥é€šè¿‡å¡«å†™ä¸€ä¸ªå·¥ä½œå•æ¥åˆ›å»ºå¾…åŠžäº‹é¡¹ã€‚

> Imagine you are designing a simple to-do factory, and you want users to create to-do items by filling out a work order.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/9.png?raw=ture)

1. **`struct CreateTodoView: View`** å°±åƒæ˜¯ä½ è®¾è®¡çš„å·¥ä½œå•è¡¨æ ¼ã€‚è¿™ä¸ªè¡¨æ ¼çš„**ç»“æž„æ˜¯å›ºå®šçš„**ï¼ŒåŒ…å«äº†ä¸åŒç§ç±»çš„è¾“å…¥æ¡†ã€å¼€å…³å’ŒæŒ‰é’®ã€‚

> Struct CreateTodoView: View is like a work order table you designed. The structure of this table is fixed and contains different types of text boxes, switches, and buttons.

1. **`@Environment(\.dismiss) var dismiss`** æ˜¯ä¸€ä¸ªâ€œ**å®Œæˆ**â€æŒ‰é’®ï¼Œå½“ç”¨æˆ·å¡«å†™å®Œå·¥ä½œå•åŽï¼Œç‚¹å‡»å®ƒå¯ä»¥å…³é—­å·¥ä½œå•ã€‚**å®ƒæ˜¯ä½ çš„é€€å‡ºæŒ‰é’®**ã€‚

> @Environment (\ .dismiss) var dismiss is a "Finish" button. When the user completes the work order, click it to close the work order. It is your exit button.

1. **`@Environment(\.modelContext) var context`** å¥½åƒæ˜¯ä¸€ä¸ªææ–™åº“ç®¡ç†å‘˜ï¼Œä»–ä¼šæŠŠç”¨æˆ·å¡«å†™çš„ä¿¡æ¯å¦¥å–„ä¿ç®¡èµ·æ¥ã€‚æ‰€æœ‰ç”¨æˆ·åˆ›å»ºçš„å¾…åŠžäº‹é¡¹éƒ½ä¼šè¢«æ”¾åœ¨è¿™ä¸ªææ–™åº“ä¸­ã€‚

> @Environment (\ .modelContext) var context seems to be a material library administrator who keeps the information filled in by users safe. All user-created to-do items will be placed in this material library.

1. **`@State private var item = ToDoItem()`** æ˜¯ä¸€å¼ å…¨æ–°çš„å¾…åŠžäº‹é¡¹å·¥ä½œå•ã€‚å½“ç”¨æˆ·æ‰“å¼€å·¥ä½œå•æ—¶ï¼Œ**å®ƒå°±æ˜¯ä¸€ä¸ªç©ºç™½çš„è¡¨æ ¼ï¼Œç­‰å¾…ç”¨æˆ·å¡«å†™**ã€‚

> @State private var item = ToDoItem () is a brand new to-do worksheet. When the user opens the worksheet, it is a blank form waiting for the user to fill out.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/10.png?raw=ture)

1. **`List { ... }`** **å¥½æ¯”æ˜¯å·¥ä½œå•ä¸Šçš„ä¸åŒéƒ¨åˆ†ã€‚**æ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰ç‰¹å®šçš„å†…å®¹ï¼Œä¾‹å¦‚ä¸€ä¸ª**æ–‡æœ¬æ¡†**ã€ä¸€ä¸ª**æ—¥æœŸé€‰æ‹©å™¨**ã€ä¸€ä¸ª**å¼€å…³**å’Œä¸€ä¸ª**æŒ‰é’®**ã€‚

> List {...} is like different sections on a work order. Each section has specific content, such as a text box, a date picker, a switch, and a button.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/11.PNG?raw=ture)

1. **`TextField("å¾…åŠžäº‹é¡¹", text: $item.title)`** æ˜¯å·¥ä½œå•ä¸Šçš„ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œç”¨æˆ·å¯ä»¥åœ¨é‡Œé¢å¡«å†™å¾…åŠžäº‹é¡¹çš„æ ‡é¢˜ã€‚

> TextField ("To-Do", text: $item.title) is a text box on a work order where users can fill in the title of the to-do item.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/12.png?raw=ture)

1. **`DatePicker("é€‰æ‹©æ—¥æœŸ", selection: $item.timestamp)`** æ˜¯å·¥ä½œå•ä¸Šçš„ä¸€ä¸ªæ—¥æœŸé€‰æ‹©å™¨ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©å¾…åŠžäº‹é¡¹çš„æˆªæ­¢æ—¥æœŸã€‚

> DatePicker ("Select Date", selection: $item.timestamp) is a date picker on the work order, allowing users to select the deadline for the to-do item.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/13.png?raw=ture)

1. **`Toggle("é‡è¦çš„?", isOn: $item.isCritical)`** ç”¨æˆ·å¯ä»¥æ ‡è®°è¿™ä¸ªå¾…åŠžäº‹é¡¹æ˜¯å¦é‡è¦ã€‚

> Toggle ("Important?", isOn: $item.isCritical) The user can mark whether this to-do is important.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/14.png?raw=ture)

1. **`Button("åˆ›å»º") { ... }`** å¥½åƒæ˜¯å·¥ä½œå•ä¸Šçš„ä¸€ä¸ªâ€œæäº¤â€æŒ‰é’®ï¼Œå½“ç”¨æˆ·å¡«å†™å®Œæ‰€æœ‰ä¿¡æ¯åŽï¼Œç‚¹å‡»å®ƒä¼šæŠŠå¡«å†™å¥½çš„ä¿¡æ¯æäº¤åˆ°ææ–™åº“ä¸­ã€‚

> Button ("Create") {...} seems to be a "Submit" button on a work order. When the user completes all the information, clicking it will submit the filled information to the material library.

1. **`context.insert(item)`** å°±åƒæ˜¯ç®¡ç†å‘˜æŠŠç”¨æˆ·å¡«å†™çš„å·¥ä½œå•å­˜æ¡£åˆ°ææ–™åº“ä¸­ã€‚è¿™ä¸ªæ“ä½œç¡®ä¿äº†ç”¨æˆ·åˆ›å»ºçš„å¾…åŠžäº‹é¡¹è¢«å¦¥å–„ä¿å­˜ã€‚

> Contextual.insert (item) is like an administrator archiving the work order filled out by the user to the material library. This operation ensures that the to-do items created by the user are properly saved.

1. **`dismiss()`** å°±åƒæ˜¯ç”¨æˆ·ç‚¹å‡»å·¥ä½œå•ä¸Šçš„â€œå®Œæˆâ€æŒ‰é’®ï¼Œè¿™ä¸ªæ“ä½œå‘Šè¯‰ç³»ç»Ÿï¼Œç”¨æˆ·å·²ç»å¡«å†™å®Œäº†å·¥ä½œå•ï¼Œå¯ä»¥å…³é—­å®ƒäº†ã€‚

> Dismiss () is like a user clicking the "Finish" button on a work order. This operation tells the system that the user has filled out the work order and can close it.

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªSwiftUIä»£ç å°±åƒæ˜¯ä¸€ä¸ªå¾…åŠžäº‹é¡¹å·¥åŽ‚çš„è®¾è®¡å›¾ï¼Œå…¶ä¸­åŒ…å«äº†å„ç§ç»„ä»¶ï¼Œç”¨æˆ·å¯ä»¥å¡«å†™å¾…åŠžäº‹é¡¹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶é€šè¿‡ç‚¹å‡»æŒ‰é’®å°†å¾…åŠžäº‹é¡¹å­˜å‚¨åœ¨ææ–™åº“ä¸­ã€‚

> Overall, this SwiftUI code is like a blueprint for a to-do factory, which contains various components. Users can fill in relevant information about to-do items and store them in the material library by clicking buttons.

# **ä¿®æ”¹å†…å®¹çš„çª—å£**

> Window for modifying content

å†™å®Œå¾…åŠžå†…å®¹ä¹‹åŽçªç„¶åˆåŽæ‚”äº†ï¼Œæˆ–è€…éœ€è¦ä¿®æ”¹æ—¶è¿˜è¦ç”¨åˆ°è¿™ä¸ªçª—å£ï¼Œé‚£ä¹Ÿå¥½åŠžï¼Œæ–°å»ºæ›´æ–°ç•Œé¢çš„æ–‡æ¡£**UpdateToDoView**ï¼Œä¸å¾—ä¸æ„Ÿæ…¨ï¼Œè¿™è‹±æ–‡å­¦å¾—è¶Šæ¥è¶Šæµåˆ©äº†ã€‚

> After finishing the to-do content, suddenly regretting it again, or needing to use this window when modifying it, that's easy to handle. Create a new document for updating the interface, UpdateToDoView. I can't help but sigh that I am becoming more and more fluent in learning English.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/15.png?raw=ture)

```Swift
import SwiftUI
import SwiftData

struct UpdateToDoView: View {
    
    @Environment(\.dismiss) var dismiss
    @Bindable var item: ToDoItem
    
    var body: some View {
        List {
            TextField("å¾…åŠžäº‹é¡¹", text: $item.title)
            DatePicker("é€‰æ‹©æ—¥æœŸ",
                       selection: $item.timestamp)
            Toggle("é‡è¦çš„?", isOn: $item.isCritical)
            Button("æ›´æ–°") {
                dismiss()
            }
        }
        .navigationTitle("æ›´æ–°åˆ°å¾…åŠž")
    }
}
```

ç›´æŽ¥å¤åˆ¶ä¸€ä»½æ”¾åœ¨è¿™é‡Œï¼Œå½“æˆ‘ä»¬ç‚¹å‡»ä¿®æ”¹çš„æŒ‰é’®åŽå°±ä¼šè·³è½¬åˆ°è¿™ä¸ªçª—å£ã€‚

> Copy a copy directly and put it here. When we click the modify button, we will jump to this window.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/16.png?raw=ture)

# **æ–°å¢žå¾…åŠžåŠŸèƒ½**

> Add to-do function

å›žåˆ°**ToDoView**è¿™ä¸ªç•Œé¢é‡Œï¼Œè¿˜è®°å¾—è¿™ä¸ªç•Œé¢å—ï¼Ÿ

> Returning to the ToDoView interface, do you remember this interface?

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/17.png?raw=ture)

åŒæ ·çš„ï¼ŒæŠŠ**SwiftData**åº“å¯¼å…¥è¿›æ¥

> Similarly, import the SwiftData library

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/18.png?raw=ture)

åœ¨ä»¥å¾€çš„åŸºç¡€ä¸ŠåŠ å…¥ä»¥ä¸‹ä»£ç ï¼š

> Add the following code based on the past:

```Swift
@Environment(\.modelContext) var context
    @State private var toDoToEdit: ToDoItem?
    @Query(
        filter: #Predicate<ToDoItem> { $0.isCompleted == false },
        sort: \.timestamp,
        order: .reverse
    ) private var items: [ToDoItem]
```

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/19.png?raw=ture)

è¿˜æ˜¯è¿›å…¥è€å¿ƒçš„å›žç­”é—®é¢˜çŽ¯èŠ‚ï¼š

> Or enter the patient question-answering session:

1. **`@Environment(\.modelContext) var context`** é€šè¿‡ **`@Environment`** **å±žæ€§åŒ…è£…å™¨**ï¼Œå£°æ˜Žäº†ä¸€ä¸ªç”¨äºŽ**ç®¡ç†æ•°æ®çš„çŽ¯å¢ƒå˜é‡** **`context`**ã€‚

> @Environment (\ .modelContext) var context declares an environment variable context for managing data through the @Environment property wrapper.

1. **`@State private var toDoToEdit: ToDoItem?`** ä½¿ç”¨äº† **`@State`** **å±žæ€§åŒ…è£…å™¨**ï¼Œå£°æ˜Žäº†ä¸€ä¸ªç§æœ‰çš„ç”¨äºŽ**å­˜å‚¨æ­£åœ¨ç¼–è¾‘çš„å¾…åŠžäº‹é¡¹**çš„çŠ¶æ€å˜é‡ **`toDoToEdit`**ã€‚

> @State private var toDoToEdit: ToDoItem? uses the @State property wrapper to declare a private state variable toDoToEdit for storing the to-do item being edited.

1. **`@Query`** å±žæ€§åŒ…è£…å™¨å£°æ˜Žäº†ä¸€ä¸ª**ç”¨äºŽæŸ¥è¯¢æœªå®Œæˆå¾…åŠžäº‹é¡¹çš„æ•°ç»„å±žæ€§** `items`ã€‚

> The @Query property wrapper declares an array of property items for querying unfinished to-do items.

åœ¨SwiftUIä¸­ï¼Œ**`@Environment`** å±žæ€§åŒ…è£…å™¨ç”¨äºŽ**è®¿é—®çŽ¯å¢ƒå˜é‡**ï¼Œ**`@State`** ç”¨äºŽ**ç®¡ç†è§†å›¾çš„å±€éƒ¨çŠ¶æ€**ï¼Œè€Œ **`@Query`** è¿™ä¸ªè‡ªå®šä¹‰å±žæ€§åŒ…è£…å™¨ï¼Œç”¨äºŽ**æ‰§è¡Œæ•°æ®æŸ¥è¯¢**ï¼Œ**è¿”å›ž**ç¬¦åˆæ¡ä»¶çš„ **`ToDoItem`** **æ•°ç»„**ã€‚

> In SwiftUI, the @Environment property wrapper is used to access environment variables, @State is used to manage the local state of the view, and the @Query custom property wrapper is used to perform data queries and return an array of ToDoItems that meet the conditions.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/20.png?raw=ture)

æ‰“äº†é…±æ²¹åˆ°çŽ°åœ¨çš„é‚£ä¸ªå¤§å¤§çš„âž•å·ç»ˆäºŽå¯ä»¥ç»™å®ƒèµ‹äºˆåº”æœ‰çš„åŠŸèƒ½äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š

> The big âž• number that has been soy sauce until now can finally give it the function it should have. The code is as follows:

```Swift
Image("ic-Add")
    .offset(x: 94, y: 273)
    .onTapGesture {
        showCreate.toggle()
    }
    .sheet(isPresented: $showCreate,
            content: {
        NavigationStack {
            CreateTodoView()
        }
        .presentationDetents([.medium])
    })
    .sheet(item: $toDoToEdit) {
        toDoToEdit = nil
    } content: { item in
        UpdateToDoView(item: item)
    }
```

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/21.png?raw=ture)

æ³¨æ„ä»£ç å±‚çº§å“ˆï¼Œè¿™ä¸ªImage()è¦æ”¾åœ¨è¿™ä¸ªä½ç½®ï¼šåœ¨ç©ºé—´å †å ZStack{}çš„æœ€ä¸‹é¢ï¼Œæ ¹æ®å€’åºçš„åŽŸåˆ™ä¹Ÿå°±æ˜¯åœ¨ç”»é¢ä¸­çš„æœ€å‰é¢ã€‚

> Pay attention to the code hierarchy. This Image () should be placed at the bottom of the spatial stack ZStack {}, which is at the front of the screen according to the principle of reverse order.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/22.png?raw=ture)

1. **`Image("ic-Add")`** ä»Žèµ„æºé‡Œè°ƒç”¨è®¾è®¡å¥½çš„æ–°å¢žæŒ‰é’®ï¼›

> Image ("ic-Add") calls the designed add button from the resource.

1. **`.offset(x: 94, y: 273)`** æŠŠå®ƒæ”¾åœ¨è¿™ä¸ªä½ç½®ï¼›

> Offset (x: 94, y: 273) puts it in this position.

1. **`.onTapGesture { showCreate.toggle() }`** ç›¸å½“äºŽåœ¨ç›¸æœºä¸Šæ”¾ç½®äº†ä¸€ä¸ªæŒ‰é’®ï¼Œå½“ä½ ç‚¹å‡»å®ƒæ—¶ï¼Œé—¨ä¼šæ‰“å¼€æˆ–å…³é—­ã€‚åœ¨è¿™é‡Œï¼Œ **`showCreate.toggle()`** æ„å‘³ç€å¦‚æžœé—¨æ˜¯æ‰“å¼€çš„ï¼Œç‚¹å‡»æŒ‰é’®ä¼šæŠŠå®ƒå…³é—­ï¼Œå¦‚æžœæ˜¯å…³é—­çš„ï¼Œç‚¹å‡»æŒ‰é’®ä¼šæŠŠå®ƒæ‰“å¼€ã€‚

> .onTapGesture {showCreate.toggle () } is equivalent to placing a button on the camera. When you click it, the door will open or close. Here, showCreate.toggle () means that if the door is open, clicking the button will close it, and if it is closed, clicking the button will open it.

1. **`.sheet(isPresented: $showCreate, content: {...})`** å°±åƒæ˜¯é—¨åŽçš„å¦ä¸€ä¸ªæˆ¿é—´ï¼Œ**åªæœ‰å½“é—¨æ‰“å¼€æ—¶æ‰èƒ½è¿›å…¥**ã€‚è¿™é‡Œçš„ **`.sheet`** å°±åƒæ˜¯å½“ä½ æ‰“å¼€é—¨æ—¶ï¼Œä½ ä¼šçœ‹åˆ°çš„æˆ¿é—´çš„æ ·å­ã€‚åœ¨è¿™ä¸ªæˆ¿é—´é‡Œï¼Œä½ ä¼šæ‰¾åˆ°ä¸€ä¸ª **`NavigationStack`**ï¼Œå®ƒç±»ä¼¼äºŽä¸€ä¸ªæˆ¿é—´é‡Œçš„å¦ä¸€ä¸ªé—¨ï¼Œé€šå‘å¦ä¸€ä¸ªåœ°æ–¹ã€‚

> .Sheet (isPresented: $showCreate, content: {...}) is like another room behind a door, which can only be entered when the door is opened. The sheet here is like the room you will see when you open the door. In this room, you will find a NavigationStack, which is similar to another door in a room leading to another place.

1. **`NavigationStack { CreateTodoView() }`** è€Œè¿™ä¸ªæˆ¿é—´é‡Œé¢æœ‰ä¸€ä¸ªåä¸º **`CreateTodoView`** çš„å¾…åŠžè®°å½•çš„ç•Œé¢ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªç•Œé¢ä¸Šå†™ä¸€äº›å†…å®¹ã€‚

> NavigationStack {CreateTodoView () } And there is an interface called CreateTodoView for to-do records in this room, where you can write some content.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/23.png?raw=ture)

1. **`.presentationDetents([.medium])`** è®¾ç½®äº†ç•Œé¢ä¸ºä¸­ç­‰ã€‚

> .PresentationDetents ([.medium]) sets the interface to medium.

1. **`.sheet(item: $toDoToEdit, content: {...})`** å°±åƒæ˜¯åœ¨å¦ä¸€ä¸ªæˆ¿é—´é‡Œæ”¾äº†ä¸€ä¸ªç‰¹æ®Šçš„è£…é¥°å“ã€‚è¿™ä¸ªè£…é¥°å“çš„å½¢çŠ¶å’Œé¢œè‰²ç”± **`toDoToEdit`** å†³å®šã€‚å½“ä½ ç‚¹å‡»è¿™ä¸ªè£…é¥°å“æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œç‰¹å®šçš„åŠ¨ä½œã€‚åœ¨è¿™é‡Œï¼Œå®ƒçš„åŠ¨ä½œæ˜¯å°† **`toDoToEdit`** è®¾ç½®ä¸º **`nil`**ï¼Œæ„å‘³ç€ä½ å¯¹è¿™ä¸ªè£…é¥°å“ä¸å†æ„Ÿå…´è¶£ã€‚

> .Sheet (item: $toDoToEdit, content: {...}) is like putting a special decoration in another room. The shape and color of this decoration are determined by toDoToEdit. When you click on this decoration, it will perform a specific action. Here, its action is to set toDoToEdit to nil, which means you are no longer interested in this decoration.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/24.png?raw=ture)

1. **`{ item in UpdateToDoView(item: item) }`** è¿™æ˜¯ä¿®æ”¹å†…å®¹çš„ç•Œé¢ï¼Œä½ ä¼šè¢«å¸¦åˆ°ä¿®æ”¹å¾…åŠžçš„ç•Œé¢**`UpdateToDoView`**ã€‚

> {Item in UpdateToDoView (item: item) } This is the interface for modifying the content. You will be taken to the interface for modifying the to-do list, UpdateToDoView.

# **å¾…åŠžåˆ—è¡¨å‘ˆçŽ°**

> Todo list presentation

åœ¨ZStack{}é‡Œæ”¾å…¥ä¸€ä¸ªæ»šåŠ¨ç•Œé¢**ScrollView{}**ç„¶åŽæ”¾å…¥ä»¥ä¸‹ä»£ç ï¼š

> Put a scrolling interface ScrollView {} in ZStack {} and then put the following code:

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/25.png?raw=ture)

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

> The complete code is as follows:

```Swift
            ScrollView{
                ZStack{
                    // todoå¡ç‰‡åº•è‰²
                    Rectangle()
                        .foregroundColor(.clear)
                        .frame(width: 393, height: 1300)
                        .background(Color(red: 0.26, green: 0.36, blue: 0.35))
                        .cornerRadius(50) // åœ†è§’
                        .offset(y: 239)
                        .padding(.top, -239)
                    // todo list
                    NavigationStack {
                        List {
                            ForEach(items) { item in
                                HStack {
                                    VStack(alignment: .leading) {
                                        if item.isCritical {
                                            Image(systemName: "exclamationmark.3")
                                                .symbolVariant(.fill)
                                                .foregroundColor(.red)
                                                .font(.largeTitle)
                                                .bold()
                                        }
                                        Text(item.title)
                                            .font(.largeTitle)
                                            .bold()
                                        Text("\(item.timestamp, format: Date.FormatStyle(date: .numeric, time: .shortened))")
                                            .font(.callout)
                                    }
                                    Spacer()
                                    Button {
                                        withAnimation {
                                            item.isCompleted.toggle()
                                        }
                                    } label: {
                                        Image(systemName: "checkmark")
                                            .symbolVariant(.circle.fill)
                                            .foregroundStyle(item.isCompleted ? .green : .gray)
                                            .font(.largeTitle)
                                    }
                                    .buttonStyle(.plain)
                                }
                                .swipeActions {
                                    Button(role: .destructive) {
                                        withAnimation {
                                            context.delete(item)
                                        }
                                    } label: {
                                        Label("åˆ é™¤", systemImage: "trash")
                                            .symbolVariant(.fill)
                                    }
                                    Button {
                                        toDoToEdit = item
                                    } label: {
                                        Label("ç¼–è¾‘", systemImage: "pencil")
                                    }
                                    .tint(.orange)
                                }
                            }
                        }
                    }
                }
            }
```

å¯è§ï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªæ¨¡å—ï¼Œä¸€ä¸ªæ˜¯ä¹‹å‰çš„åº•è‰²ï¼Œå¦ä¸€ä¸ªå°±æ˜¯å¾…åŠžåˆ—è¡¨çš„å®¹å™¨ï¼›

> It can be seen that there are two modules here, one is the previous base color, and the other is the container of the to-do list.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/26.png?raw=ture)

è¿™ä¸ªå®¹å™¨é‡Œæœ‰ä¸ªå¯ä»¥å¾ªçŽ¯åŠ å…¥å’Œåˆ é™¤çš„åˆ—è¡¨ï¼Œ

> There is a list in this container that can be added and deleted in a loop.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/27.png?raw=ture)

è¿™ä¸ªåˆ—è¡¨é‡Œçš„æ¯ä¸€ä¸ªå¾…åŠžéƒ½æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼š**åˆ é™¤** å’Œ **ç¼–è¾‘**

> Each to-do in this list has two functions: delete and edit

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/28.png?raw=ture)

è¿™æ®µä»£ç ä½¿ç”¨äº†SwiftUIçš„**`swipeActions`**ä¿®é¥°ç¬¦ï¼Œç”¨äºŽåœ¨ç”¨æˆ·åœ¨ç•Œé¢ä¸Šæ»‘åŠ¨æŸä¸ªå…ƒç´ æ—¶ï¼Œæ˜¾ç¤ºä¸€ç»„è‡ªå®šä¹‰çš„æ»‘åŠ¨æ“ä½œã€‚

> This code uses the swipeActions modifier of SwiftUI to display a set of custom swipe operations when the user slides an element on the interface.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/29.png?raw=ture)

1. **`.swipeActions { ... }`**ï¼š

è¿™æ˜¯ä¸€ä¸ªè§†å›¾ä¿®é¥°ç¬¦ï¼Œå®ƒå‘Šè¯‰SwiftUIåœ¨å½“å‰è§†å›¾ä¸Šå¯ç”¨æ»‘åŠ¨æ‰‹åŠ¿ï¼Œå¹¶å®šä¹‰äº†æ»‘åŠ¨æ—¶æ˜¾ç¤ºçš„æ“ä½œã€‚åœ¨è¿™ä¸ªä¿®é¥°ç¬¦çš„å¤§æ‹¬å·å†…ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªæ»‘åŠ¨æ“ä½œæŒ‰é’®ã€‚

> This is a view modifier that tells SwiftUI to enable sliding gestures on the current view and defines the actions displayed when sliding. Within the curly braces of this modifier, you can define one or more sliding action buttons.

1. **`Button(role: .destructive) { ... } label: { ... }`**ï¼š

è¿™æ˜¯ä¸€ä¸ªæŒ‰é’®ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ä¼šæ‰§è¡Œå…¶ä¸­çš„é—­åŒ…ã€‚è¿™ä¸ªæŒ‰é’®æœ‰ä¸€ä¸ª`.`**`destructive`**çš„è§’è‰²ï¼Œæ„å‘³ç€å®ƒæ‰§è¡Œçš„æ“ä½œå¯èƒ½ä¼šåˆ é™¤æ•°æ®æˆ–è€…å…·æœ‰ç ´åæ€§çš„è¡Œä¸ºã€‚åœ¨è¿™ä¸ªæŒ‰é’®ä¸­ï¼Œæ‰§è¡Œäº†ä¸€ä¸ª**`withAnimation`**é—­åŒ…ï¼Œå®ƒåŒ…å«äº†ä»Žæ•°æ®æºï¼ˆ**`context`**ï¼‰ä¸­åˆ é™¤**`item`**çš„æ“ä½œã€‚å½“ç”¨æˆ·æ»‘åŠ¨å¹¶ç‚¹å‡»è¿™ä¸ªæŒ‰é’®æ—¶ï¼Œä¼šè§¦å‘åˆ é™¤æ“ä½œï¼Œå¹¶ä¸”å¸¦æœ‰ä¸€ä¸ªå¸¦æœ‰åžƒåœ¾æ¡¶å›¾æ ‡çš„æ ‡ç­¾ã€‚

> This is a button that will execute its closure when clicked by the user. This button has a .destructive role, which means that the operation it performs may delete data or have destructive behavior. In this button, a withAnimation closure is executed, which includes the operation of deleting items from the data source (context). When the user slides and clicks this button, the deletion operation will be triggered, and it will come with a label with a trash can icon.

1. **`Button { ... } label: { ... } .tint(.orange)`**ï¼š

è¿™æ˜¯å¦ä¸€ä¸ªæŒ‰é’®ï¼Œä¸å…·æœ‰ç ´åæ€§è§’è‰²ã€‚å½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªæŒ‰é’®æ—¶ï¼Œä¼šå°†**`item`**ä¼ é€’ç»™**`toDoToEdit`**ï¼Œå¯ç”¨äºŽè¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚è¿™ä¸ªæŒ‰é’®çš„æ ‡ç­¾ä¸Šæœ‰ä¸€ä¸ªç¼–è¾‘å›¾æ ‡ã€‚**`.tint(.orange)`**è¿™ä¸€è¡Œä»£ç è¡¨ç¤ºæŒ‰é’®çš„é¢œè‰²ä¼šè¢«è®¾ç½®ä¸ºæ©™è‰²ã€‚

> This is another button that does not have a destructive role. When the user clicks on this button, the item will be passed to toDoToEdit, which can be used to enter edit mode. There is an edit icon on the label of this button. The .tint (.orange) line of code indicates that the color of the button will be set to orange.

è¿™ç•Œé¢ç”¨è‹¹æžœçš„å°ä¼™ä¼´å°±éžå¸¸ç†Ÿæ‚‰å¯¹ä¸ï¼Ÿå°±æ˜¯è¿™æ ·å†™å‡ºæ¥çš„ï¼Œè¿™ç§è®¾è®¡è®©ç”¨æˆ·åœ¨åº”ç”¨ä¸­çš„åˆ—è¡¨ä¸­é€šè¿‡æ»‘åŠ¨æ‰‹åŠ¿ï¼Œæ–¹ä¾¿åœ°æ‰§è¡Œåˆ é™¤å’Œç¼–è¾‘æ“ä½œï¼Œæä¾›äº†æ›´ç›´è§‚å’Œé«˜æ•ˆçš„ç”¨æˆ·ä½“éªŒã€‚æŠŠè¿™ä¸ªåŠŸèƒ½èµ‹äºˆç»™HStack{}é‡Œçš„å…ƒç´ ï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªä¸œè¥¿ï¼Œç”¨Spacer()åˆ†éš”å¼€ï¼š

> This interface is very familiar to Apple friends, right? It is written like this. This design allows users to easily perform deletion and editing operations through swiping gestures in the list in the application, providing a more intuitive and efficient User Experience. Give this function to the elements in HStack {}, where there are two things separated by Spacer ():

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/30.png?raw=ture)

æ¥çœ‹çœ‹ç¬¬ä¸€ä¸ª

> Let's take a look at the first one

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/31.png?raw=ture)

è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªåž‚ç›´çš„è§†å›¾å †æ ˆï¼ˆVStackï¼‰ï¼Œå…¶ä¸­åŒ…å«äº†ä¸‰ä¸ªè§†å›¾å…ƒç´ ï¼š

> This code creates a vertical view stack (VStack) containing three view elements.

1. **`VStack(alignment: .leading) { ... }`****ï¼š**

è¿™æ˜¯ä¸€ä¸ªåž‚ç›´çš„è§†å›¾å®¹å™¨ï¼ˆVStackï¼‰ï¼Œå®ƒå°†åŒ…å«åœ¨å¤§æ‹¬å·å†…çš„è§†å›¾åž‚ç›´æŽ’åˆ—ã€‚**`.alignment(.leading)`**è¡¨ç¤ºæ‰€æœ‰çš„å­è§†å›¾å°†å·¦å¯¹é½æŽ’åˆ—ã€‚

> This is a vertical view container (VStack) that arranges the views contained in braces vertically. .alignment (.leading) indicates that all sub-views will be left-aligned.

1. **`if item.isCritical { ... }`**ï¼š

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/32.png?raw=ture)

è¿™æ˜¯ä¸€ä¸ªæ¡ä»¶è¯­å¥ï¼Œå®ƒæ£€æŸ¥`item`å¯¹è±¡çš„**`isCritical`**å±žæ€§æ˜¯å¦ä¸ºçœŸï¼Œ**ä¹Ÿå°±æ˜¯è¿™æ¡å¾…åŠžæ˜¯å¦é‡è¦**ã€‚å¦‚æžœ**`isCritical`**ä¸ºçœŸï¼Œå°†ä¼šæ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰çº¢è‰²æ„Ÿå¹å·å›¾æ ‡çš„å›¾åƒã€‚è¿™ä¸ª**å›¾æ ‡æ˜¯ä¸€ä¸ªå¡«å……ï¼ˆ.fillï¼‰çš„ç¬¦å·**ï¼Œ**é¢œè‰²ä¸ºçº¢è‰²**ï¼ˆ.foregroundColor(.red)ï¼‰ï¼Œå­—ä½“å¤§å°ä¸º**å¤§å·**ï¼ˆ.largeTitleï¼‰å¹¶ä¸”**åŠ ç²—**ï¼ˆ.bold()ï¼‰ã€‚è¿™ä¸ªéƒ¨åˆ†åªæœ‰åœ¨ç”¨æˆ·è®¾ç½®ä¸ºé‡è¦çš„æ—¶å€™æ‰ä¼šè¢«æ¸²æŸ“å‡ºæ¥ã€‚

> This is a conditional statement that checks whether the isCritical property of the item object is true, that is, whether the task is important. If isCritical is true, an image with a red exclamation mark icon will be displayed. This icon is a fill symbol with a color of red (.foregroundColor (.red)), a font size of large (.largeTitle), and bold (.bold ()). This section will only be rendered when the user sets it to important.

1. **`Text(item.title) .font(.largeTitle) .bold()`**ï¼š

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/33.png?raw=ture)

è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬è§†å›¾ï¼Œç”¨äºŽæ˜¾ç¤º`item`å¯¹è±¡çš„`title`å±žæ€§ã€‚**æ–‡æœ¬**çš„å­—ä½“å¤§å°è®¾ç½®ä¸º**å¤§å·**ï¼ˆ.largeTitleï¼‰å¹¶ä¸”**åŠ ç²—**ï¼ˆ.bold()ï¼‰ã€‚

> This is a text view used to display the title property of the item object. The font size of the text is set to large (.largeTitle) and bold (.bold ()).

1. **`Text("\(item.timestamp, format: Date.FormatStyle(date: .numeric, time: .shortened))") .font(.callout)`**ï¼š

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/34.png?raw=ture)

è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡æœ¬è§†å›¾ï¼Œç”¨äºŽæ˜¾ç¤º`item`å¯¹è±¡çš„`timestamp`å±žæ€§ã€‚**æ—¶é—´æˆ³**å°†ä»¥**æ•°å­—æ ¼å¼**ï¼ˆ.numericï¼‰**æ˜¾ç¤ºæ—¥æœŸéƒ¨åˆ†**ï¼Œä»¥ç¼©å†™æ ¼å¼ï¼ˆ.shortenedï¼‰æ˜¾ç¤ºæ—¶é—´éƒ¨åˆ†ã€‚æ–‡æœ¬çš„å­—ä½“å¤§å°è®¾ç½®**ä¸ºè¾ƒå°çš„å­—å·**ï¼ˆ.calloutï¼‰ã€‚

> This is also a text view used to display the timestamp property of the item object. timestamp will display the date part in numeric format (.numeric) and the time part in abbreviated format (.shortened). The font size of the text is set to a smaller font size (.callout).

åœ¨æ•´ä½“ä¸Šï¼Œè¿™ä¸ªåž‚ç›´å †æ ˆä»¥å·¦å¯¹é½çš„æ–¹å¼æ˜¾ç¤ºäº†å¾…åŠžäº‹é¡¹ï¼ˆitemï¼‰çš„ä¿¡æ¯ã€‚å¦‚æžœ`item`è¢«æ ‡è®°ä¸ºâ€œé‡è¦â€ï¼ˆisCriticalä¸ºçœŸï¼‰ï¼Œåˆ™ä¼šæ˜¾ç¤ºä¸€ä¸ªçº¢è‰²çš„æ„Ÿå¹å·å›¾æ ‡ï¼Œç„¶åŽæ˜¾ç¤ºå¾…åŠžäº‹é¡¹çš„æ ‡é¢˜å’Œæ—¶é—´æˆ³ã€‚å¦‚æžœ`isCritical`ä¸ºå‡ï¼Œåªä¼šæ˜¾ç¤ºæ ‡é¢˜å’Œæ—¶é—´æˆ³ã€‚

> Overall, this vertical stack displays information about the to-do items in a left-aligned manner. If the item is marked as "important" (isCritical is true), a red exclamation mark icon will be displayed, followed by the title and timestamp of the to-do item. If isCritical is false, only the title and timestamp will be displayed.

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/35.png?raw=ture)

ç„¶åŽå°±æ˜¯è¿™åŽé¢çš„æŒ‰é’®ðŸ”˜ï¼Œç”¨äºŽåˆ‡æ¢ä¸€ä¸ªå¾…åŠžäº‹é¡¹ï¼ˆitemï¼‰çš„å®ŒæˆçŠ¶æ€ã€‚

> Then there is the button ðŸ”˜ behind it, which is used to toggle the completion status of an item.

1. **`Button { ... } label: { ... }`**ï¼š

å½“ç”¨æˆ·ç‚¹å‡»å®ƒæ—¶ï¼Œä¼šæ‰§è¡ŒåŒ…å«åœ¨å¤§æ‹¬å·ä¸­çš„ä»£ç å—ã€‚æŒ‰é’®çš„æ ‡ç­¾éƒ¨åˆ†åŒ…å«ä¸€ä¸ªå›¾åƒï¼Œç”¨äºŽæ˜¾ç¤ºå¾…åŠžäº‹é¡¹æ˜¯å¦å·²å®Œæˆã€‚

> When the user clicks on it, the Code Block contained in braces will be executed. The label part of the button contains an image to show whether the to-do list has been completed.

1. **`withAnimation { item.isCompleted.toggle() }`**ï¼š

è¿™æ˜¯æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å¤„ç†ç¨‹åºã€‚å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œè¿™ä¸ªä»£ç å—ä¼šæ‰§è¡Œã€‚**`withAnimation`**æ˜¯ä¸€ä¸ª**åŠ¨ç”»åŒ…è£…å™¨**ï¼Œå®ƒç”¨äºŽåœ¨**åˆ‡æ¢**`item`çš„`isCompleted`å±žæ€§æ—¶**æ·»åŠ åŠ¨ç”»æ•ˆæžœ**ã€‚**`item.isCompleted.toggle()`** ä¼šå°†`item`çš„`isCompleted`å±žæ€§ä»Žå·²å®Œæˆåˆ‡æ¢åˆ°æœªå®Œæˆï¼Œæˆ–è€…ä»Žæœªå®Œæˆåˆ‡æ¢åˆ°å·²å®Œæˆï¼Œå…·ä½“å–å†³äºŽå½“å‰çš„çŠ¶æ€ã€‚

> This is the click event handler for the button. When the user clicks the button, this Code Block will be executed. withAnimation is an animation wrapper used to add animation effects when switching the isCompleted property of an item. item.isCompleted.toggle () will switch the isCompleted property of the item from completed to incomplete, or from never completed to completed, depending on the current state.

1. **`Image(systemName: "checkmark")`****` ...`**ï¼š

è¿™æ˜¯æŒ‰é’®çš„æ ‡ç­¾éƒ¨åˆ†ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªå›¾åƒï¼Œç”¨äºŽæ˜¾ç¤ºå¾…åŠžäº‹é¡¹çš„å®ŒæˆçŠ¶æ€ã€‚å›¾åƒçš„åå­—æ˜¯ "checkmark"ï¼Œå®ƒä»£è¡¨äº†**ä¸€ä¸ªå‹¾é€‰çš„æ ‡å¿—**ã€‚`.symbolVariant(.circle.fill)` è¡¨ç¤ºå›¾åƒæ ·å¼æ˜¯å¡«å……çš„åœ†åœˆï¼Œ`.foregroundStyle(...)` æ ¹æ®`item.isCompleted` çš„å€¼è®¾ç½®å›¾åƒçš„å‰æ™¯è‰²ï¼Œ**å·²å®Œæˆçš„äº‹é¡¹æ˜¯ç»¿è‰²ï¼Œæœªå®Œæˆçš„æ˜¯ç°è‰²**ã€‚`.font(.largeTitle)` è®¾ç½®äº†å›¾åƒçš„å­—ä½“å¤§å°ã€‚

> This is the label part of the button, which contains an image used to display the completion status of the to-do list. The name of the image is "checkmark", which represents a check mark. .symbolVariant (.circle.fill) indicates that the image style is a filled circle, .foregroundStyle (...) sets the foreground color of the image based on the value of item.isCompleted. Completed items are green and unfinished items are gray. .font (.largeTitle) sets the font size of the image.

1. **`.buttonStyle(.plain)`**ï¼š

è¿™ä¸€è¡Œä»£ç è®¾ç½®äº†æŒ‰é’®çš„æ ·å¼ï¼Œ`.plain` è¡¨ç¤ºæŒ‰é’®æ˜¯**ä¸€ä¸ªç®€å•çš„æŒ‰é’®**ï¼Œæ²¡æœ‰ç‰¹å®šçš„æ ·å¼ã€‚

> This line of code sets the style of the button, .plain means that the button is a simple button with no specific style.

# **å¤§åŠŸå‘Šæˆ**

> Done

æ¥æ¬£èµä¸€ä¸‹æœ€ç»ˆçš„æˆæžœå§ï¼Œç¦»ä¸Šæž¶AppStoreåˆè¿›ä¸€æ­¥äº†ï¼

> Come and enjoy the final result, one step closer to being launched on the App Store!

![img](https://github.com/zhoukunlin/ImageBed/blob/main/é…å›¾åº“/SwfitDataTty/36.gif?raw=ture)

æ„Ÿè°¢ä½ çš„ç²¾è¿›ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ã€‚

> Thank you for your dedication. See you next time.

**æ ‡ç­¾**

> Tags

[Swift](https://kxv36hgn51.feishu.cn/wiki/GSFewSmhqizDXfksatCc7QQ6nid)[ç¼–ç¨‹](https://kxv36hgn51.feishu.cn/wiki/wikcnGrTUbs5WbYYtM9qRhQyp6g)[Swiftæœ€å°å®Œæ•´åŠŸèƒ½](https://kxv36hgn51.feishu.cn/wiki/PSkiwes1ziufoFkP1jVcggimnph)

å‚è€ƒæ–‡çŒ®

> References

[1] https://youtu.be/kLNNNXD8X2U?si=ZLQyWmthAOtlHSIE
